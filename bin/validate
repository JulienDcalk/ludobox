#!/usr/bin/env python
# -*- coding: utf-8 -*-


import os

from ludobox import create_app
from ludobox.content import validate_content, read_content, ValidationError

data_dir = os.path.join(os.getcwd(), 'data')

class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'

if __name__ == '__main__':

    app=create_app()
    with app.app_context():

        for game_folder_name in os.listdir(data_dir) :

            errors = []

            path = os.path.join(data_dir,game_folder_name)

            # get only folders
            if os.path.isdir(path):
                info_file = os.path.join(path, "info.json")
                if os.path.exists(info_file):
                    info = read_content(path)
                    errors = validate_content(info, get_all_errors=True)
                    if len(errors):
                        print info["title"] + bcolors.FAIL + "  %s ERRORS."%len(errors) + bcolors.ENDC
                    else :
                        print bcolors.OKGREEN + info["title"] + " " + u"\u2713" + bcolors.ENDC
